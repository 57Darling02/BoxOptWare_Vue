import{u as le}from"./Container-Bmgy86J_.js";import{_ as te}from"./trs3d.vue_vue_type_script_setup_true_lang-DHa1gyZ6.js";import{e as E}from"./trs3d.vue_vue_type_style_index_0_lang-D7gnPIi1.js";import{d as oe,B as T,r as w,y as ne,q as N,j as a,m as d,b as n,c as v,s as W,a as l,F as U,p as B,e as c,h as s,t as m,E as se,l as L,o as u,_ as ae}from"./index-CS_7zquX.js";import{u as ue}from"./Box-CLp3t-LY.js";const re=M=>new Promise((z,_)=>{const t=new Worker(new URL("/assets/block.worker-HMRtrw59.js",import.meta.url),{type:"module"});t.onmessage=i=>{i.data.type==="SUCCESS"?(z(i.data.data),t.terminate()):(_(new Error(i.data.error)),t.terminate())},t.postMessage({type:"CALCULATE",data:JSON.parse(JSON.stringify(M))})}),ie={key:0,class:"show"},de={class:"boxstep"},me={key:1,class:"show"},ve={class:"containerstep"},pe={key:2,class:"show"},be={class:"carbox"},fe={class:"carbox"},ce={key:3,class:"show"},_e={class:"sidebarbox"},ge={key:0,class:"sidebarbox"},xe={key:1,class:"sidebarbox"},ye={key:2,class:"sidebarbox"},we={key:3},ke={class:"sidebarbox"},Ce={class:"sidebarbox"},Ve=["onClick"],Se={style:{padding:"12px","border-top":"1px solid var(--el-border-color)"}},he=oe({__name:"mainWorkPage",setup(M){const z=le(),{container_list:_}=T(z),t=w(0),i=w(),$=()=>{if(++t.value>3){t.value=3;return}t.value==0||t.value==1?console.log(t.value):t.value==2?(console.log(t.value),G()):t.value==3&&(async()=>{const r=se.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{i.value=await re(k),console.log("result",i.value)}catch(e){console.log("计算失败",e)}finally{r.close()}})()},j=()=>{if(--t.value<0){t.value=0;return}},J=ue(),{Box_list:g}=T(J),h=w(!1),V=w(!1),p=w([]),S=w([]);ne(p,r=>{r.length===0?(h.value=!1,V.value=!1):r.length===g.value.length?(h.value=!0,V.value=!1):V.value=!0,S.value=new Array(r.length).fill(1),console.log("Selected  goods:",p.value)});const q=r=>{V.value=!1,r?(p.value=g.value.map((e,f)=>f),console.log("All  goods selected")):(p.value=[],console.log("All  goods deselected"))},x=w(0);let k={name:_.value[x.value].name,containers:[],boxes:[],num_list:[]};function G(){if(p.value.length<=0){L({message:"请选择货物"}),t.value=0;return}else if(p.value.length!==S.value.length){L({message:"货物数量异常"}),t.value=0;return}else if(x.value<0||x.value>=_.value.length){L({message:"请选择集装箱"}),t.value=1;return}const r=_.value[x.value],e=r.module;e.length==0&&e.push({lx:r.lx,ly:r.ly,lz:r.lz,name:r.name,x:0,y:0,z:0}),k={name:_.value[x.value].name,containers:e,boxes:[],num_list:S.value};for(const f of p.value){const C=g.value[f];k.boxes.push({lx:C.lx,ly:C.ly,lz:C.lz,id:f})}}function P(r=[],e=[],f){E.emit("showModules",e),E.emit("centerOfGravityPosition",f),E.emit("showBoxes",r)}return(r,e)=>{const f=d("el-checkbox"),C=d("el-option"),R=d("el-select"),H=d("el-input-number"),y=d("el-table-column"),I=d("el-table"),K=d("el-main"),D=d("el-container"),A=d("el-step"),Q=d("el-steps"),X=d("el-scrollbar"),F=d("el-button"),O=d("el-col"),Y=d("el-row"),Z=d("el-aside");return u(),N(D,{class:"layout-container",style:{height:"100%"}},{default:a(()=>[n(D,null,{default:a(()=>[n(K,null,{default:a(()=>[t.value==0?(u(),v("div",ie,[e[5]||(e[5]=l("h1",null,"- 选择货物种类",-1)),n(R,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),multiple:"",clearable:"","collapse-tags":"",placeholder:"Select goods","popper-class":"custom-header","max-collapse-tags":1,style:{width:"240px"}},{header:a(()=>[n(f,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=o=>h.value=o),indeterminate:V.value,onChange:q},{default:a(()=>e[4]||(e[4]=[s(" 全选 ")])),_:1},8,["modelValue","indeterminate"])]),default:a(()=>[(u(!0),v(U,null,B(c(g),(o,b)=>(u(),N(C,{key:b,label:o.name,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[6]||(e[6]=l("h1",null,"- 选择货物数量",-1)),(u(!0),v(U,null,B(p.value,(o,b)=>(u(),v("div",de,[s(" 货物 "+m(c(g)[o].name)+" 数量为 ",1),n(H,{min:1,modelValue:S.value[b],"onUpdate:modelValue":ee=>S.value[b]=ee},null,8,["modelValue","onUpdate:modelValue"])]))),256))])):t.value==1?(u(),v("div",me,[e[7]||(e[7]=l("h1",null,"- 选择集装箱",-1)),l("div",ve,[n(R,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=o=>x.value=o),placeholder:"Select",size:"large",style:{width:"240px"}},{default:a(()=>[(u(!0),v(U,null,B(c(_),(o,b)=>(u(),N(C,{key:o.name,label:o.name,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):t.value==2?(u(),v("div",pe,[e[9]||(e[9]=l("h2",null,"最终确认",-1)),l("div",be," 集装箱："+m(c(k).name),1),l("div",fe,[e[8]||(e[8]=l("h3",null,"货物清单",-1)),n(I,{data:c(k).boxes,stripe:"",style:{width:"100%"}},{default:a(()=>[n(y,{prop:"id",label:"编号",width:"auto"}),n(y,{label:"货物名称",width:"auto"},{default:a(({row:o})=>[s(m(c(g)[o.id].name),1)]),_:1}),n(y,{prop:"lx",label:"长",width:"auto"}),n(y,{prop:"ly",label:"宽",width:"auto"}),n(y,{prop:"lz",label:"高",width:"auto"}),n(y,{label:"数量",width:"auto"},{default:a(({row:o,$index:b})=>[s(m(c(k).num_list[b]),1)]),_:1}),n(y,{label:"货物质量",width:"auto"},{default:a(({row:o})=>[s(m(c(g)[o.id].mass),1)]),_:1})]),_:1},8,["data"])])])):t.value==3?(u(),v("div",ce,[n(te)])):W("",!0)]),_:1})]),_:1}),n(Z,{"max-width":"25%",style:{display:"flex","flex-direction":"column"}},{default:a(()=>[n(X,null,{default:a(()=>[l("div",_e,[n(Q,{style:{"max-width":"600px"},active:t.value,"finish-status":"success","align-center":""},{default:a(()=>[n(A),n(A),n(A)]),_:1},8,["active"])]),t.value==0?(u(),v("div",ge," - 选择货物种类及数量 ")):t.value==1?(u(),v("div",xe," - 选择集装箱 ")):t.value==2?(u(),v("div",ye," - 根据货物和集装箱类型分配模块 ")):t.value==3?(u(),v("div",we,[l("div",ke,[l("h2",null,"集装箱:"+m(i.value.container.name),1),e[10]||(e[10]=s(" 模块总容积:")),e[11]||(e[11]=l("br",null,null,-1)),s(m(i.value.container.volumn)+" 平方厘米 ",1),e[12]||(e[12]=l("br",null,null,-1)),e[13]||(e[13]=s(" 货物体积:")),e[14]||(e[14]=l("br",null,null,-1)),s(m(i.value.container.boxesvolumn)+" 平方厘米 ",1),e[15]||(e[15]=l("br",null,null,-1)),e[16]||(e[16]=s(" 体积利用率:")),e[17]||(e[17]=l("br",null,null,-1)),s(m(i.value.container.volumnUR*100)+"% ",1),e[18]||(e[18]=l("br",null,null,-1)),e[19]||(e[19]=s(" 重心坐标:")),e[20]||(e[20]=l("br",null,null,-1)),s(m(i.value.container.gravityCenter)+" ",1),l("button",{onClick:e[3]||(e[3]=o=>P(i.value.container.allbox,i.value.container.allmodules,i.value.container.gravityCenter))},"3D")]),(u(!0),v(U,null,B(i.value.modules,o=>(u(),v("div",Ce,[l("h4",null,"模块:"+m(o.name),1),e[21]||(e[21]=s(" 模块容积:")),e[22]||(e[22]=l("br",null,null,-1)),s(m(o.volumn)+" 平方厘米 ",1),e[23]||(e[23]=l("br",null,null,-1)),e[24]||(e[24]=s(" 货物体积:")),e[25]||(e[25]=l("br",null,null,-1)),s(m(o.boxesvolumn)+" 平方厘米 ",1),e[26]||(e[26]=l("br",null,null,-1)),e[27]||(e[27]=s(" 体积利用率:")),e[28]||(e[28]=l("br",null,null,-1)),s(m(o.volumnUR*100)+"% ",1),e[29]||(e[29]=l("br",null,null,-1)),e[30]||(e[30]=s(" 重心坐标:")),e[31]||(e[31]=l("br",null,null,-1)),s(m(o.gravityCenter)+" ",1),l("button",{onClick:b=>P(o.boxes,[o.showModule],o.showModule.centerPosition)},"3D",8,Ve)]))),256))])):W("",!0)]),_:1}),l("div",Se,[n(Y,{gutter:20,align:"middle"},{default:a(()=>[n(O,{span:8},{default:a(()=>[n(F,{type:"primary",plain:"",onClick:j,style:{width:"100%"}},{default:a(()=>e[32]||(e[32]=[s(" 上一步 ")])),_:1})]),_:1}),n(O,{span:16},{default:a(()=>[n(F,{type:"primary",plain:"",onClick:$,style:{width:"100%"}},{default:a(()=>e[33]||(e[33]=[s(" 下一步 ")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),Ne=ae(he,[["__scopeId","data-v-d0b3523e"]]);export{Ne as default};
