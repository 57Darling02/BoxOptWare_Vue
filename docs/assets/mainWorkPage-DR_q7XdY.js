import{u as te}from"./Container-4VIxtNd3.js";import{_ as ne}from"./tres3d.vue_vue_type_script_setup_true_lang-CsEOyfGQ.js";import{e as N}from"./tres3d.vue_vue_type_style_index_0_lang-CTMRHt9u.js";import{d as oe,C as W,r as k,y as ae,f as se,q as F,j as u,m,b as n,c as v,s as z,a as t,F as h,p as V,e as b,h as p,t as r,E as ue,l as L,o as s,_ as re}from"./index-D6QYwPHy.js";import{u as ie}from"./Box-8CMxLC-q.js";const de=$=>new Promise((M,g)=>{const a=new Worker(new URL("/assets/block.worker-H-bvGZA3.js",import.meta.url),{type:"module"});a.onmessage=o=>{o.data.type==="SUCCESS"?(M(o.data.data),a.terminate()):(g(new Error(o.data.error)),a.terminate())},a.postMessage({type:"CALCULATE",data:JSON.parse(JSON.stringify($))})}),ve={key:0,class:"show"},me={class:"containerstep"},pe={class:"boxstep"},be={key:1,class:"show"},ce={class:"carbox"},fe={class:"carbox"},_e={key:2,class:"show"},xe={class:"sidebarbox"},ge={key:0,class:"sidebarbox"},ye={key:1},we={key:0,class:"hw2"},ke=["onClick"],Ce={class:"hw"},he={key:0,class:"hw2"},Ve=["onClick"],Se={style:{padding:"12px","border-top":"1px solid var(--el-border-color)"}},Be=oe({__name:"mainWorkPage",setup($){const M=te(),{container_list:g}=W(M),a=k(0),o=k(),P=i=>i.map(e=>e.toFixed(1)),j=()=>{if(++a.value>2){a.value=2;return}a.value==0?console.log(a.value):a.value==1?(console.log(a.value),H()):a.value==2&&(async()=>{const i=ue.service({lock:!0,text:"Loading",background:"rgba(0, 0, 0, 0.7)"});try{o.value=await de(x),console.log("result",o.value),U(o.value.container.allbox,o.value.container.allmodules,o.value.container.gravityCenter)}catch(e){console.log("计算失败",e)}finally{i.close()}})()},G=()=>{if(--a.value<0){a.value=0;return}},J=ie(),{Box_list:f}=W(J),A=k(!1),S=k(!1),c=k([]),B=k([]);ae(c,i=>{i.length===0?(A.value=!1,S.value=!1):i.length===f.value.length?(A.value=!0,S.value=!1):S.value=!0,B.value=new Array(i.length).fill(1),console.log("Selected  goods:",c.value)});const q=i=>{S.value=!1,i?(c.value=f.value.map((e,_)=>_),console.log("All  goods selected")):(c.value=[],console.log("All  goods deselected"))},y=k(0);let x=se({name:g.value[y.value].name,containers:[],boxes:[],num_list:[]});function H(){if(c.value.length<=0){L({message:"请选择货物"}),a.value=0;return}else if(c.value.length!==B.value.length){L({message:"货物数量异常"}),a.value=0;return}else if(y.value<0||y.value>=g.value.length){L({message:"请选择集装箱"}),a.value=1;return}const i=g.value[y.value],e=i.module;e.length==0&&e.push({lx:i.lx,ly:i.ly,lz:i.lz,name:i.name,x:0,y:0,z:0}),x={name:g.value[y.value].name,containers:e,boxes:[],num_list:B.value};for(const _ of c.value){const C=f.value[_];x.boxes.push({lx:C.lx,ly:C.ly,lz:C.lz,id:_})}}function U(i=[],e=[],_){N.emit("showModules",e),N.emit("centerOfGravityPosition",_),N.emit("showBoxes",i)}return(i,e)=>{const _=m("el-option"),C=m("el-select"),I=m("el-checkbox"),Z=m("el-input-number"),w=m("el-table-column"),K=m("el-table"),Q=m("el-main"),R=m("el-container"),D=m("el-step"),X=m("el-steps"),Y=m("el-scrollbar"),O=m("el-button"),T=m("el-col"),ee=m("el-row"),le=m("el-aside");return s(),F(R,{class:"layout-container",style:{height:"100%"}},{default:u(()=>[n(R,null,{default:u(()=>[n(Q,null,{default:u(()=>[a.value==0?(s(),v("div",ve,[e[6]||(e[6]=t("h1",null,"- 选择集装箱",-1)),t("div",me,[n(C,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=l=>y.value=l),placeholder:"Select",size:"large",style:{width:"240px"}},{default:u(()=>[(s(!0),v(h,null,V(b(g),(l,d)=>(s(),F(_,{key:l.name,label:l.name,value:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e[7]||(e[7]=t("h1",null,"- 选择货物种类及数量",-1)),n(C,{modelValue:c.value,"onUpdate:modelValue":e[2]||(e[2]=l=>c.value=l),multiple:"",clearable:"","collapse-tags":"",placeholder:"Select goods","popper-class":"custom-header","max-collapse-tags":1,style:{width:"240px"}},{header:u(()=>[n(I,{modelValue:A.value,"onUpdate:modelValue":e[1]||(e[1]=l=>A.value=l),indeterminate:S.value,onChange:q},{default:u(()=>e[5]||(e[5]=[p(" 全选 ")])),_:1},8,["modelValue","indeterminate"])]),default:u(()=>[(s(!0),v(h,null,V(b(f),(l,d)=>(s(),F(_,{key:d,label:l.name,value:d},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),(s(!0),v(h,null,V(c.value,(l,d)=>(s(),v("div",pe,[p(" 货物 "+r(b(f)[l].name)+" 数量为 ",1),n(Z,{min:1,modelValue:B.value[d],"onUpdate:modelValue":E=>B.value[d]=E},null,8,["modelValue","onUpdate:modelValue"])]))),256))])):a.value==1?(s(),v("div",be,[e[9]||(e[9]=t("h2",null,"最终确认",-1)),t("div",ce," 集装箱："+r(b(x).name),1),t("div",fe,[e[8]||(e[8]=t("h3",null,"货物清单",-1)),n(K,{data:b(x).boxes,stripe:"",style:{width:"100%"}},{default:u(()=>[n(w,{prop:"id",label:"编号",width:"auto"}),n(w,{label:"货物名称",width:"auto"},{default:u(({row:l})=>[p(r(b(f)[l.id].name),1)]),_:1}),n(w,{prop:"lx",label:"长",width:"auto"}),n(w,{prop:"ly",label:"宽",width:"auto"}),n(w,{prop:"lz",label:"高",width:"auto"}),n(w,{label:"数量",width:"auto"},{default:u(({row:l,$index:d})=>[p(r(b(x).num_list[d]),1)]),_:1}),n(w,{label:"货物质量",width:"auto"},{default:u(({row:l})=>[p(r(b(f)[l.id].mass),1)]),_:1})]),_:1},8,["data"])])])):a.value==2?(s(),v("div",_e,[n(ne)])):z("",!0)]),_:1})]),_:1}),n(le,{"max-width":"25%",style:{display:"flex","flex-direction":"column"}},{default:u(()=>[n(Y,null,{default:u(()=>[t("div",xe,[n(X,{style:{"max-width":"600px"},active:a.value,"finish-status":"success","align-center":""},{default:u(()=>[n(D),n(D)]),_:1},8,["active"])]),a.value==0?(s(),v("div",ge," - 选择集装箱、货物种类及数量 ")):z("",!0),a.value==2&&o.value!=null?(s(),v("div",ye,[t("div",{class:"sidebarbox",onClick:e[4]||(e[4]=l=>U(o.value.container.allbox,o.value.container.allmodules,o.value.container.gravityCenter))},[t("h2",null,"集装箱:"+r(o.value.container.name),1),e[10]||(e[10]=t("b",null,"模块总容积:",-1)),e[11]||(e[11]=t("br",null,null,-1)),p(r(o.value.container.volumn)+" 平方厘米 ",1),e[12]||(e[12]=t("br",null,null,-1)),e[13]||(e[13]=t("b",null,"货物体积:",-1)),e[14]||(e[14]=t("br",null,null,-1)),p(r(o.value.container.boxesvolumn)+" 平方厘米 ",1),e[15]||(e[15]=t("br",null,null,-1)),e[16]||(e[16]=t("b",null,"体积利用率:",-1)),e[17]||(e[17]=t("br",null,null,-1)),p(r((o.value.container.volumnUR*100).toFixed(3))+"% ",1),e[18]||(e[18]=t("br",null,null,-1)),e[19]||(e[19]=t("b",null,"重心坐标:",-1)),e[20]||(e[20]=t("br",null,null,-1)),p(r(P(o.value.container.gravityCenter))+" ",1),(s(!0),v(h,null,V(o.value.container.restBoxnum,(l,d)=>(s(),v("div",{class:"hw",key:d},[l?(s(),v("div",we,r(b(f)[b(x).boxes[d].id].name)+" 剩余数量为 "+r(o.value.container.restBoxnum[d]),1)):z("",!0)]))),128)),e[21]||(e[21]=t("br",null,null,-1)),t("button",{onClick:e[3]||(e[3]=l=>U(o.value.container.allbox,o.value.container.allmodules,o.value.container.gravityCenter))},"3D")]),(s(!0),v(h,null,V(o.value.modules,l=>(s(),v("div",{class:"sidebarbox",onClick:d=>U(l.boxes,[l.showModule],l.showModule.gravityCenter)},[t("h4",null,"模块:"+r(l.name),1),e[22]||(e[22]=t("b",null,"模块容积:",-1)),p(r(l.volumn)+" 平方厘米 ",1),e[23]||(e[23]=t("br",null,null,-1)),e[24]||(e[24]=t("b",null,"货物体积:",-1)),p(r(l.boxesvolumn)+" 平方厘米 ",1),e[25]||(e[25]=t("br",null,null,-1)),e[26]||(e[26]=t("b",null,"体积利用率:",-1)),p(r((l.volumnUR*100).toFixed(3))+"% ",1),e[27]||(e[27]=t("br",null,null,-1)),e[28]||(e[28]=t("b",null,"重心坐标:",-1)),p(r(P(l.gravityCenter))+" ",1),(s(!0),v(h,null,V(l.num_list,(d,E)=>(s(),v("div",Ce,[d?(s(),v("div",he,r(b(f)[b(x).boxes[E].id].name)+" 数量为 "+r(l.num_list[E]),1)):z("",!0)]))),256)),t("button",{onClick:d=>U(l.boxes,[l.showModule],l.showModule.gravityCenter)},"3D",8,Ve)],8,ke))),256))])):z("",!0)]),_:1}),t("div",Se,[n(ee,{gutter:20,align:"middle"},{default:u(()=>[n(T,{span:8},{default:u(()=>[n(O,{type:"primary",plain:"",onClick:G,style:{width:"100%"}},{default:u(()=>e[29]||(e[29]=[p(" 上一步 ")])),_:1})]),_:1}),n(T,{span:16},{default:u(()=>[n(O,{type:"primary",plain:"",onClick:j,style:{width:"100%"}},{default:u(()=>e[30]||(e[30]=[p(" 下一步 ")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})}}}),Ne=re(Be,[["__scopeId","data-v-f2891ea4"]]);export{Ne as default};
